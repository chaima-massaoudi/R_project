---
title: "Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠ"
subtitle: "Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©"
---

```{r}
#| label: setup
#| include: false

.libPaths(Sys.getenv("R_LIBS_USER"))
library(tidyverse)
library(knitr)
library(kableExtra)

source("R/load_data.R")
```

## ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙˆØµÙÙŠØ© {.unnumbered}

```{r}
#| label: descriptive-stats

cat("ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù†Ø³Ø¨ Ø§Ù„Ù†Ø¬Ø§Ø­:\n")
cat("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n")

cat("Ø§Ù„Ù…ØªÙˆØ³Ø·:", round(mean(school_data$success_rate, na.rm = TRUE), 2), "%\n")
cat("Ø§Ù„ÙˆØ³ÙŠØ·:", round(median(school_data$success_rate, na.rm = TRUE), 2), "%\n")
cat("Ø§Ù„Ø§Ù†Ø­Ø±Ø§Ù Ø§Ù„Ù…Ø¹ÙŠØ§Ø±ÙŠ:", round(sd(school_data$success_rate, na.rm = TRUE), 2), "\n")
cat("Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰:", round(min(school_data$success_rate, na.rm = TRUE), 2), "%\n")
cat("Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰:", round(max(school_data$success_rate, na.rm = TRUE), 2), "%\n")
cat("Ø§Ù„Ù…Ø¯Ù‰:", round(max(school_data$success_rate, na.rm = TRUE) - min(school_data$success_rate, na.rm = TRUE), 2), "\n")
```

---

## ğŸ”¬ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ {.unnumbered}

```{r}
#| label: normality-test

# Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ø¨ÙŠØ±Ùˆ-ÙˆÙŠÙ„Ùƒ
sample_data <- sample(school_data$success_rate, min(5000, nrow(school_data)))
shapiro_result <- shapiro.test(sample_data)

cat("ğŸ“ˆ Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ø¨ÙŠØ±Ùˆ-ÙˆÙŠÙ„Ùƒ Ù„Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ:\n")
cat("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n")
cat("Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ© W =", round(shapiro_result$statistic, 4), "\n")
cat("Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© p =", format(shapiro_result$p.value, scientific = TRUE), "\n\n")

if(shapiro_result$p.value < 0.05) {
  cat("ğŸ”´ Ø§Ù„Ù†ØªÙŠØ¬Ø©: Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø§ ØªØªØ¨Ø¹ Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ (p < 0.05)\n")
  cat("ğŸ“ Ø§Ù„ØªÙˆØµÙŠØ©: Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ù„Ø§Ù…Ø¹Ù„Ù…ÙŠØ©\n")
} else {
  cat("ğŸŸ¢ Ø§Ù„Ù†ØªÙŠØ¬Ø©: Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªØªØ¨Ø¹ Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ\n")
}
```

```{r}
#| label: fig-qq
#| fig-cap: "Ø±Ø³Ù… Q-Q Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ"
#| fig-width: 10
#| fig-height: 6

ggplot(school_data, aes(sample = success_rate)) +
  stat_qq(color = "#3498db", alpha = 0.6) +
  stat_qq_line(color = "#e74c3c", linewidth = 1) +
  labs(
    title = "Ø±Ø³Ù… Q-Q Ù„Ù†Ø³Ø¨ Ø§Ù„Ù†Ø¬Ø§Ø­",
    subtitle = "Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„ÙØ¹Ù„ÙŠ Ø¨Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ Ø§Ù„Ù†Ø¸Ø±ÙŠ",
    x = "Ø§Ù„ÙƒÙ…ÙŠØ§Øª Ø§Ù„Ù†Ø¸Ø±ÙŠØ©",
    y = "Ø§Ù„ÙƒÙ…ÙŠØ§Øª Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø©"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5, color = "#7f8c8d")
  )
```

---

## ğŸ” Ø§Ø®ØªØ¨Ø§Ø± ÙƒØ±ÙˆØ³ÙƒØ§Ù„-ÙˆØ§Ù„ÙŠØ³ {.unnumbered}

Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙØ±ÙˆÙ‚Ø§Øª Ø¨ÙŠÙ† Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª ÙÙŠ Ù†Ø³Ø¨ Ø§Ù„Ù†Ø¬Ø§Ø­:

```{r}
#| label: kruskal-test

kruskal_result <- kruskal.test(success_rate ~ governorate, 
                                data = school_data %>% filter(!is.na(governorate)))

cat("ğŸ“Š Ø§Ø®ØªØ¨Ø§Ø± ÙƒØ±ÙˆØ³ÙƒØ§Ù„-ÙˆØ§Ù„ÙŠØ³ (Ø§Ù„ÙØ±ÙˆÙ‚Ø§Øª Ø¨ÙŠÙ† Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª):\n")
cat("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n")
cat("Ø¥Ø­ØµØ§Ø¦ÙŠØ© Chi-squared =", round(kruskal_result$statistic, 2), "\n")
cat("Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø­Ø±ÙŠØ© df =", kruskal_result$parameter, "\n")
cat("Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© p =", format(kruskal_result$p.value, scientific = TRUE), "\n\n")

if(kruskal_result$p.value < 0.05) {
  cat("ğŸ”´ Ø§Ù„Ù†ØªÙŠØ¬Ø©: ØªÙˆØ¬Ø¯ ÙØ±ÙˆÙ‚Ø§Øª Ø°Ø§Øª Ø¯Ù„Ø§Ù„Ø© Ø¥Ø­ØµØ§Ø¦ÙŠØ© Ø¨ÙŠÙ† Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª!\n")
  cat("ğŸ“ Ø§Ù„ØªÙØ³ÙŠØ±: Ù†Ø³Ø¨ Ø§Ù„Ù†Ø¬Ø§Ø­ ØªØ®ØªÙ„Ù Ø§Ø®ØªÙ„Ø§ÙÙ‹Ø§ Ø¬ÙˆÙ‡Ø±ÙŠÙ‹Ø§ Ø­Ø³Ø¨ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ\n")
} else {
  cat("ğŸŸ¢ Ø§Ù„Ù†ØªÙŠØ¬Ø©: Ù„Ø§ ØªÙˆØ¬Ø¯ ÙØ±ÙˆÙ‚Ø§Øª Ø°Ø§Øª Ø¯Ù„Ø§Ù„Ø© Ø¥Ø­ØµØ§Ø¦ÙŠØ©\n")
}
```

```{r}
#| label: fig-boxplot
#| fig-cap: "ØªÙˆØ²ÙŠØ¹ Ù†Ø³Ø¨ Ø§Ù„Ù†Ø¬Ø§Ø­ Ø­Ø³Ø¨ Ø§Ù„ÙˆÙ„Ø§ÙŠØ©"
#| fig-width: 14
#| fig-height: 10

school_data %>%
  filter(!is.na(governorate_ar)) %>%
  ggplot(aes(x = reorder(governorate_ar, success_rate, FUN = median), y = success_rate)) +
  geom_boxplot(aes(fill = governorate_ar), show.legend = FALSE, alpha = 0.7) +
  scale_fill_viridis_d() +
  coord_flip() +
  labs(
    title = "ØªÙˆØ²ÙŠØ¹ Ù†Ø³Ø¨ Ø§Ù„Ù†Ø¬Ø§Ø­ Ø­Ø³Ø¨ Ø§Ù„ÙˆÙ„Ø§ÙŠØ©",
    subtitle = "ÙƒÙ„ ØµÙ†Ø¯ÙˆÙ‚ ÙŠÙ…Ø«Ù„ ØªÙˆØ²ÙŠØ¹ Ù†Ø³Ø¨ Ø§Ù„Ù†Ø¬Ø§Ø­ ÙÙŠ Ø§Ù„Ù…Ø¯Ø§Ø±Ø³",
    x = "",
    y = "Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­ (%)"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5, size = 18),
    plot.subtitle = element_text(hjust = 0.5, color = "#7f8c8d"),
    axis.text.y = element_text(size = 10, face = "bold")
  )
```

---

## ğŸ“ˆ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· {.unnumbered}

```{r}
#| label: correlation

cor_result <- cor.test(school_data$nb_students, school_data$success_rate)

cat("ğŸ“Š Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· (Ø­Ø¬Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø© vs Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­):\n")
cat("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n")
cat("Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· r =", round(cor_result$estimate, 4), "\n")
cat("Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© p =", format(cor_result$p.value, scientific = TRUE), "\n\n")

if(abs(cor_result$estimate) < 0.3) {
  cat("ğŸ“ Ø§Ù„ØªÙØ³ÙŠØ±: Ø§Ø±ØªØ¨Ø§Ø· Ø¶Ø¹ÙŠÙ - Ø­Ø¬Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ù„Ø§ ÙŠØ¤Ø«Ø± Ø¨Ø´ÙƒÙ„ ÙƒØ¨ÙŠØ± Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¬Ø§Ø­\n")
} else if(abs(cor_result$estimate) < 0.7) {
  cat("ğŸ“ Ø§Ù„ØªÙØ³ÙŠØ±: Ø§Ø±ØªØ¨Ø§Ø· Ù…ØªÙˆØ³Ø·\n")
} else {
  cat("ğŸ“ Ø§Ù„ØªÙØ³ÙŠØ±: Ø§Ø±ØªØ¨Ø§Ø· Ù‚ÙˆÙŠ\n")
}
```

```{r}
#| label: fig-scatter
#| fig-cap: "Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ø¨ÙŠÙ† Ø­Ø¬Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø© ÙˆÙ†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­"
#| fig-width: 12
#| fig-height: 8

ggplot(school_data, aes(x = nb_students, y = success_rate)) +
  geom_point(alpha = 0.4, color = "#3498db") +
  geom_smooth(method = "lm", color = "#e74c3c", se = TRUE) +
  labs(
    title = "Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ø¨ÙŠÙ† Ø­Ø¬Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø© ÙˆÙ†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­",
    subtitle = paste("Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· r =", round(cor_result$estimate, 3)),
    x = "Ø¹Ø¯Ø¯ Ø§Ù„ØªÙ„Ø§Ù…ÙŠØ°",
    y = "Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­ (%)"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5, color = "#7f8c8d")
  )
```

---

## ğŸ“‹ Ù…Ù„Ø®Øµ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ© {.unnumbered}

```{r}
#| label: summary-table

summary_tests <- data.frame(
  Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± = c(
    "Ø´Ø§Ø¨ÙŠØ±Ùˆ-ÙˆÙŠÙ„Ùƒ (Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ)",
    "ÙƒØ±ÙˆØ³ÙƒØ§Ù„-ÙˆØ§Ù„ÙŠØ³ (ÙØ±ÙˆÙ‚Ø§Øª Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª)",
    "Ø¨ÙŠØ±Ø³ÙˆÙ† (Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø·)"
  ),
  Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ© = c(
    paste("W =", round(shapiro_result$statistic, 3)),
    paste("Ï‡Â² =", round(kruskal_result$statistic, 2)),
    paste("r =", round(cor_result$estimate, 3))
  ),
  Ø§Ù„Ù‚ÙŠÙ…Ø©_Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© = c(
    format(shapiro_result$p.value, scientific = TRUE),
    format(kruskal_result$p.value, scientific = TRUE),
    format(cor_result$p.value, scientific = TRUE)
  ),
  Ø§Ù„Ù†ØªÙŠØ¬Ø© = c(
    ifelse(shapiro_result$p.value < 0.05, "ğŸ”´ ØºÙŠØ± Ø·Ø¨ÙŠØ¹ÙŠ", "ğŸŸ¢ Ø·Ø¨ÙŠØ¹ÙŠ"),
    ifelse(kruskal_result$p.value < 0.05, "ğŸ”´ ÙØ±ÙˆÙ‚Ø§Øª Ø¯Ø§Ù„Ø©", "ğŸŸ¢ Ù„Ø§ ÙØ±ÙˆÙ‚Ø§Øª"),
    ifelse(abs(cor_result$estimate) < 0.3, "âšª Ø§Ø±ØªØ¨Ø§Ø· Ø¶Ø¹ÙŠÙ", "ğŸ”µ Ø§Ø±ØªØ¨Ø§Ø· Ù…ØªÙˆØ³Ø·/Ù‚ÙˆÙŠ")
  )
)

summary_tests %>%
  kable(col.names = c("Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±", "Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ©", "Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ©", "Ø§Ù„Ù†ØªÙŠØ¬Ø©")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

---

## ğŸ’¡ Ø§Ù„Ø§Ø³ØªÙ†ØªØ§Ø¬Ø§Øª {.unnumbered}

::: {.callout-tip}
## Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©

1. **Ø§Ù„ØªÙˆØ²ÙŠØ¹ ØºÙŠØ± Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ**: Ù†Ø³Ø¨ Ø§Ù„Ù†Ø¬Ø§Ø­ Ù„Ø§ ØªØªØ¨Ø¹ Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØŒ Ù…Ù…Ø§ ÙŠØ³ØªØ¯Ø¹ÙŠ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ù„Ø§Ù…Ø¹Ù„Ù…ÙŠØ©.

2. **ÙØ±ÙˆÙ‚Ø§Øª Ø¬Ù‡ÙˆÙŠØ© ÙƒØ¨ÙŠØ±Ø©**: ØªÙˆØ¬Ø¯ ÙØ±ÙˆÙ‚Ø§Øª Ø°Ø§Øª Ø¯Ù„Ø§Ù„Ø© Ø¥Ø­ØµØ§Ø¦ÙŠØ© Ø¹Ø§Ù„ÙŠØ© Ø¨ÙŠÙ† Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª ÙÙŠ Ù†Ø³Ø¨ Ø§Ù„Ù†Ø¬Ø§Ø­.

3. **Ø­Ø¬Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©**: Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø§Ø±ØªØ¨Ø§Ø· Ù‚ÙˆÙŠ Ø¨ÙŠÙ† Ø­Ø¬Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø© ÙˆÙ†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­ØŒ Ù…Ù…Ø§ ÙŠØ¹Ù†ÙŠ Ø£Ù† Ø¹ÙˆØ§Ù…Ù„ Ø£Ø®Ø±Ù‰ Ù‡ÙŠ Ø§Ù„Ù…Ø¤Ø«Ø±Ø©.
:::
