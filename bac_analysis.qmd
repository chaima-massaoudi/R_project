---
title: "๐ ุชุญููู ุงูุจุงูุงููุฑูุง ุงููุงูู"
subtitle: "ุชุญููู ุดุงูู ููุณุจ ูุฌุงุญ ุจุงูุงููุฑูุง 2025"
---

```{r}
#| label: setup
#| include: false

.libPaths(Sys.getenv("R_LIBS_USER"))
library(tidyverse)
library(knitr)
library(kableExtra)
library(scales)

source("R/load_data.R")
source("R/bac_data.R")
```

## ๐ ููุฏูุฉ {.unnumbered}

::: {.callout-important appearance="simple"}
## ๐ฏ ุงููุฏู
ุชุญููู ูุชุงุฆุฌ ุจุงูุงููุฑูุง 2025 ุงูุฑุณููุฉ ูููุงุฑูุชูุง ุจุฃุฏุงุก ุงูุชูุงููุฐ ุฎูุงู ุงูุณููุงุช ุงูุฏุฑุงุณูุฉุ ูุชุญุฏูุฏ ููุงุท ุงูุถุนู ูุงููุฌูุงุช ูู ุงูููุธููุฉ ุงูุชุนููููุฉ.
:::

---

## ๐ ูุชุงุฆุฌ ุจุงูุงููุฑูุง 2025 ุญุณุจ ุงูุดุนุจุฉ {.unnumbered}

```{r}
#| label: bac-field-summary

cat("๐ ูุณุจ ูุฌุงุญ ุจุงูุงููุฑูุง 2025 ุญุณุจ ุงูุดุนุจุฉ:\n")
cat("โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ\n\n")

for(i in 1:nrow(bac_by_field)) {
  emoji <- if(bac_by_field$bac_success_rate[i] >= 70) "๐" 
           else if(bac_by_field$bac_success_rate[i] >= 50) "โ"
           else if(bac_by_field$bac_success_rate[i] >= 35) "โ๏ธ"
           else "๐จ"
  
  cat(paste0(emoji, " ", bac_by_field$field_ar[i], ": ", bac_by_field$bac_success_rate[i], "%\n"))
}
```

```{r}
#| label: fig-bac-fields
#| fig-cap: "ูุณุจ ูุฌุงุญ ุจุงูุงููุฑูุง 2025 ุญุณุจ ุงูุดุนุจุฉ"
#| fig-width: 14
#| fig-height: 10

ggplot(bac_by_field, aes(x = reorder(field_ar, bac_success_rate), y = bac_success_rate)) +
  geom_col(aes(fill = bac_success_rate), width = 0.75, show.legend = FALSE) +
  geom_text(aes(label = paste0(bac_success_rate, "%")), hjust = -0.1, size = 6, fontface = "bold") +
  geom_hline(yintercept = 50, linetype = "dashed", color = "#e74c3c", linewidth = 1.2) +
  scale_fill_gradient2(low = "#c0392b", mid = "#f39c12", high = "#27ae60", midpoint = 50) +
  coord_flip() +
  ylim(0, 85) +
  labs(
    title = "๐ ุจุงูุงููุฑูุง 2025 - ุงููุฌุงุญ ุญุณุจ ุงูุดุนุจุฉ",
    subtitle = "ุงููุชุงุฆุฌ ุงูุฑุณููุฉ: ุงูุฏูุฑุฉ ุงูุฑุฆูุณูุฉ ูุงููุฑุงูุจุฉ",
    x = "",
    y = "ูุณุจุฉ ุงููุฌุงุญ (%)"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5, size = 24),
    plot.subtitle = element_text(hjust = 0.5, size = 14, color = "#7f8c8d"),
    axis.text.y = element_text(size = 14, face = "bold")
  )
```

---

## ๐บ๏ธ ูุชุงุฆุฌ ุจุงูุงููุฑูุง 2025 ุญุณุจ ุงูููุงูุฉ {.unnumbered}

```{r}
#| label: fig-bac-gov
#| fig-cap: "ุชุฑุชูุจ ุงูููุงูุงุช ุญุณุจ ูุณุจุฉ ุงููุฌุงุญ ูู ุจุงูุงููุฑูุง 2025"
#| fig-width: 14
#| fig-height: 14

ggplot(bac_by_governorate, aes(x = reorder(governorate_ar, bac_success_rate), y = bac_success_rate)) +
  geom_segment(aes(xend = governorate_ar, yend = 40), color = "gray80", linewidth = 1) +
  geom_point(aes(color = bac_success_rate, size = candidates), show.legend = TRUE) +
  geom_text(aes(label = paste0(bac_success_rate, "%")), hjust = -0.3, size = 4, fontface = "bold") +
  scale_color_gradient2(low = "#c0392b", mid = "#f39c12", high = "#27ae60", midpoint = 55, name = "ูุณุจุฉ\nุงููุฌุงุญ") +
  scale_size_continuous(range = c(4, 12), name = "ุงููุชุฑุดุญูู", labels = comma) +
  geom_hline(yintercept = 50, linetype = "dashed", color = "#e74c3c", linewidth = 1) +
  coord_flip() +
  ylim(40, 78) +
  labs(
    title = "๐ ุชุฑุชูุจ ุงูููุฏูุจูุงุช ุงูุฌูููุฉ",
    subtitle = "ุชุฑุชูุจ ุญุณุจ ูุณุจุฉ ุงููุฌุงุญ ูู ุจุงูุงููุฑูุง 2025",
    x = "",
    y = "ูุณุจุฉ ุงููุฌุงุญ (%)"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5, size = 22),
    plot.subtitle = element_text(hjust = 0.5, size = 14, color = "#7f8c8d"),
    axis.text.y = element_text(size = 11, face = "bold")
  )
```

### ๐ ุฃูุถู ูุฃุถุนู ุงูููุงูุงุช

```{r}
#| label: top-bottom

top_5 <- bac_by_governorate %>% head(5)
bottom_5 <- bac_by_governorate %>% tail(5) %>% arrange(bac_success_rate)

cat("๐ ุฃูุถู 5 ููุงูุงุช:\n")
for(i in 1:5) {
  cat(paste0("   ", i, ". ", top_5$governorate_ar[i], " - ", top_5$bac_success_rate[i], 
             "% (", format(top_5$passed[i], big.mark=","), "/", format(top_5$candidates[i], big.mark=","), ")\n"))
}

cat("\n๐ ุฃุถุนู 5 ููุงูุงุช:\n")
for(i in 1:5) {
  cat(paste0("   ", i, ". ", bottom_5$governorate_ar[i], " - ", bottom_5$bac_success_rate[i], "%\n"))
}

gap <- max(bac_by_governorate$bac_success_rate) - min(bac_by_governorate$bac_success_rate)
cat("\n๐ ุงููุฌูุฉ:", round(gap, 2), "ููุทุฉ ุจูู ุตูุงูุณ 1 ูุฌูุฏูุจุฉ")
```

---

## ๐ ุงููุฌูุฉ ุจูู ุงูุฃุฏุงุก ุงููุฏุฑุณู ูุงูุจุงูุงููุฑูุง {.unnumbered}

::: {.callout-warning}
## โก ุงูุญูููุฉ ุงูุตุงุฏูุฉ
ุงูุชูุงููุฐ ููุฌุญูู ูู ุณููุงุชูู ุงูุฏุฑุงุณูุฉ ุจูุณุจุฉ **85-95%**ุ ููููู ููุงุฌููู **ุงูุฎูุงุถูุง ุญุงุฏูุง** ูู ุงูุจุงูุงููุฑูุง!
:::

```{r}
#| label: fig-gap
#| fig-cap: "ุงููุฌูุฉ ุงูุญููููุฉ ุจูู ุงูุฃุฏุงุก ุงููุฏุฑุณู ูุงูุจุงูุงููุฑูุง"
#| fig-width: 14
#| fig-height: 10

comparison_data <- tibble(
  field = c("๐ ุงูุขุฏุงุจ", "๐ผ ุงูุงูุชุตุงุฏ", "โ๏ธ ุงูุนููู ุงูุชูููุฉ", "๐ฌ ุงูุนููู ุงูุชุฌุฑูุจูุฉ", 
            "๐ป ุนููู ุงูุฅุนูุงููุฉ", "๐ ุงูุฑูุงุถุฉ", "๐ข ุงูุฑูุงุถูุงุช"),
  prebac_estimate = c(90.5, 85.4, 88.2, 92.5, 94.1, 97.8, 97.2),
  bac_actual = c(23.02, 28.95, 35.02, 45.83, 48.47, 73.33, 74.93)
) %>%
  mutate(gap = prebac_estimate - bac_actual)

comparison_long <- comparison_data %>%
  pivot_longer(cols = c(prebac_estimate, bac_actual), 
               names_to = "exam_type", values_to = "success_rate") %>%
  mutate(exam_label = if_else(exam_type == "prebac_estimate", "๐ ูุง ูุจู ุงูุจุงู", "๐ ุจุงูุงููุฑูุง 2025"))

ggplot(comparison_long, aes(x = reorder(field, success_rate), y = success_rate, fill = exam_label)) +
  geom_col(position = "dodge", width = 0.7) +
  geom_text(aes(label = paste0(success_rate, "%")), 
            position = position_dodge(width = 0.7), hjust = -0.1, size = 4, fontface = "bold") +
  scale_fill_manual(values = c("๐ ูุง ูุจู ุงูุจุงู" = "#27ae60", "๐ ุจุงูุงููุฑูุง 2025" = "#c0392b"), name = "") +
  coord_flip() +
  ylim(0, 110) +
  labs(
    title = "๐ ุงููุฌูุฉ ุงูุญููููุฉ",
    subtitle = "ุงูุฃุฏุงุก ุงููุฏุฑุณู ููุงุจู ูุชุงุฆุฌ ุงูุจุงูุงููุฑูุง 2025",
    x = "",
    y = "ูุณุจุฉ ุงููุฌุงุญ (%)"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5, size = 24, color = "#c0392b"),
    plot.subtitle = element_text(hjust = 0.5, size = 14, color = "#7f8c8d"),
    legend.position = "bottom"
  )
```

### ๐ ุฌุฏูู ุงููุฌูุฉ

```{r}
#| label: gap-table

comparison_data %>%
  arrange(desc(gap)) %>%
  mutate(
    prebac = paste0(prebac_estimate, "%"),
    bac = paste0(bac_actual, "%"),
    drop = paste0("๐ป -", round(gap, 1), " ููุทุฉ")
  ) %>%
  select(field, prebac, bac, drop) %>%
  kable(col.names = c("ุงูุดุนุจุฉ", "ูุง ูุจู ุงูุจุงู", "ุจุงูุงููุฑูุง 2025", "ุงูุงูุฎูุงุถ")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
  column_spec(4, color = "#c0392b", bold = TRUE)
```

---

## ๐ ุงูููุฎุต ุงูููุงุฆู {.unnumbered}

```{r}
#| label: final-summary

total_candidates <- sum(bac_by_governorate$candidates)
total_passed <- sum(bac_by_governorate$passed)
national_rate <- round(total_passed / total_candidates * 100, 2)

summary_df <- data.frame(
  ุงููุคุดุฑ = c(
    "๐ ูุณุจุฉ ุงููุฌุงุญ ุงููุทููุฉ",
    "๐ฅ ุฅุฌูุงูู ุงููุชุฑุดุญูู",
    "โ ุฅุฌูุงูู ุงููุงุฌุญูู",
    "๐ข ุฃูุถู ุดุนุจุฉ",
    "๐ ุฃุถุนู ุดุนุจุฉ",
    "๐ ุฃูุถู ููุงูุฉ",
    "๐ ุฃุถุนู ููุงูุฉ",
    "๐ ุฃูุจุฑ ูุฌูุฉ"
  ),
  ุงููููุฉ = c(
    paste0(national_rate, "%"),
    format(total_candidates, big.mark = ","),
    format(total_passed, big.mark = ","),
    "ุงูุฑูุงุถูุงุช (74.93%)",
    "ุงูุขุฏุงุจ (23.02%)",
    "ุตูุงูุณ 1 (71.31%)",
    "ุฌูุฏูุจุฉ (43.08%)",
    "ุงูุขุฏุงุจ: -67 ููุทุฉ!"
  )
)

summary_df %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

---

## ๐ฏ ุงูุชูุตูุงุช {.unnumbered}

::: {.callout-tip}
## ุฎุทุฉ ุงูุนูู ูุชุญุณูู ูุชุงุฆุฌ ุงูุจุงูุงููุฑูุง

1. **๐จ ุนุงุฌู: ุงูุขุฏุงุจ ูุงูุงูุชุตุงุฏ** - ูุณุจ ูุฌุงุญ 23-29% ููุท. ูุฑุงุฌุนุฉ ุดุงููุฉ ููููุงูุฌ ูุทููุจุฉ.

2. **๐บ๏ธ ุฏุนู ุงูููุงูุงุช ุงููุชุฃุฎุฑุฉ** - ุฌูุฏูุจุฉุ ุฒุบูุงูุ ุงูููุฑูุงูุ ููุตุฉ ุชุญุชุงุฌ ุชุฏุฎูุงู ุนุงุฌูุงู.

3. **๐ ุฅุตูุงุญ ุงูุชูููู ุงููุฏุฑุณู** - ุงููุฌูุฉ ุงููุจูุฑุฉ ุชุดูุฑ ุฅูู ุชุถุฎู ูู ุงูุฏุฑุฌุงุช ุงููุฏุฑุณูุฉ.

4. **๐ข ุงูุชุนูู ูู ุงููุฌุงุญ** - ุฏุฑุงุณุฉ ุฃุณุจุงุจ ุชููู ุดุนุจุชู ุงูุฑูุงุถูุงุช ูุงูุฑูุงุถุฉ.

5. **๐ ูุดุฑ ุฃูุถู ุงูููุงุฑุณุงุช** - ุชุนููู ุชุฌุฑุจุฉ ุตูุงูุณ ููุฏููู ุนูู ุจุงูู ุงูููุงูุงุช.
:::

---

::: {.callout-important}
## ๐ฎ ุงูุฎูุงุตุฉ
ุงูููุธููุฉ ุงูุชุนููููุฉ ุงูุชููุณูุฉ ุชุนุงูู ูู **ุฃุฒูุฉ ุชุญุถูุฑ** ุญููููุฉ. ุงูุชูุงููุฐ ูุจุฏูู ูุงุฌุญูู (85-95%) ููููู ููุดููู ูู ุงูุงุฎุชุจุงุฑ ุงูุญูููู (23-75%). ุงูุญู ูุชุทูุจ:

- ูุทุงุจูุฉ ุงูุชููููุงุช ุงููุฏุฑุณูุฉ ูุน ุตุนูุจุฉ ุงูุจุงูุงููุฑูุง
- ุฏุนู ุงูุดุนุจ ูุงูููุงูุงุช ุงูุถุนููุฉ
- ุชุญุถูุฑ ุงูุชูุงููุฐ ููุชุญุฏูุงุช ุงูุญููููุฉ
:::
